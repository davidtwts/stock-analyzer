# è¨­è¨ˆæ–‡ä»¶ï¼šå°è‚¡å³æ™‚ç¯©é¸ç³»çµ± (Stage 1.5)

> **å»ºç«‹æ—¥æœŸ:** 2026-01-18
> **ç‹€æ…‹:** å·²æ ¸å‡†ï¼Œå¾…å¯¦ä½œ

---

## 1. å°ˆæ¡ˆæ¦‚è¿°

å°‡éœæ…‹ Excel åˆ†æå‡ç´šç‚ºå³æ™‚æŠ“å– Yahoo Finance çœŸå¯¦è‚¡å¸‚æ•¸æ“šçš„è‡ªå‹•åŒ–ç³»çµ±ï¼Œå…·å‚™ Web å„€è¡¨æ¿ä»‹é¢ã€‚

### æ ¸å¿ƒåŠŸèƒ½
- **æ•¸æ“šè‡ªå‹•åŒ–**ï¼šä½¿ç”¨ yfinance API æŠ“å–å°ç£ 50 æˆåˆ†è‚¡æ­·å²æ•¸æ“š
- **ç­–ç•¥ç¯©é¸**ï¼šå‡ç·šå¤šé ­æ’åˆ— + æç›Šæ¯”é¢¨æ§
- **è¦–è¦ºåŒ–å„€è¡¨æ¿**ï¼šVue.js å‰ç«¯é¡¯ç¤ºç¯©é¸çµæœèˆ‡ K ç·šåœ–

---

## 2. ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend (Vue.js)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  è‚¡ç¥¨æ¸…å–®   â”‚  â”‚   Kç·šåœ–è¡¨   â”‚  â”‚   å‡ç·šè¦–è¦ºåŒ–    â”‚  â”‚
â”‚  â”‚  (ç¯©é¸çµæœ) â”‚  â”‚ (TradingViewâ”‚  â”‚   (ç–ŠåŠ é¡¯ç¤º)    â”‚  â”‚
â”‚  â”‚             â”‚  â”‚  Lightweight)â”‚  â”‚                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ HTTP (æ¯5åˆ†é˜è¼ªè©¢)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Backend (FastAPI)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ /api/stocks â”‚  â”‚ /api/chart  â”‚  â”‚  èƒŒæ™¯æ’ç¨‹å™¨     â”‚  â”‚
â”‚  â”‚ (ç¯©é¸çµæœ)  â”‚  â”‚ (Kç·šæ•¸æ“š)   â”‚  â”‚ (APScheduler)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                          â”‚                               â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚         â”‚         Core Engine             â”‚             â”‚
â”‚         â”‚  â€¢ data_engine.py (yfinance)    â”‚             â”‚
â”‚         â”‚  â€¢ screener.py (ç­–ç•¥é‚è¼¯)       â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€è¡“é¸å‹
- **å¾Œç«¯**: FastAPI + APScheduler + yfinance + pandas
- **å‰ç«¯**: Vue 3 + Tailwind CSS + Lightweight Charts
- **æ›´æ–°é »ç‡**: æ¯ 5 åˆ†é˜ (ç›¤ä¸­ 09:00-13:30)

---

## 3. ç­–ç•¥é‚è¼¯

### 3.1 å‡ç·šå¤šé ­æ’åˆ—
**æ¢ä»¶**: 5MA > 10MA > 20MA > 60MA

```python
def check_ma_alignment(df):
    latest = df.iloc[-1]
    return (latest['ma5'] > latest['ma10'] >
            latest['ma20'] > latest['ma60'])
```

### 3.2 æç›Šæ¯”è¨ˆç®—
**ç›®æ¨™**: >= 3:1

```python
def calculate_risk_reward(df, current_price):
    # åœæ: å– 20MA èˆ‡è¿‘20æ—¥æœ€ä½é»çš„è¼ƒå°å€¼
    stop_loss = min(df.iloc[-1]['ma20'], df['Low'].tail(20).min())

    # é¢¨éšª
    risk = current_price - stop_loss

    # åœåˆ©: 3å€é¢¨éšª
    take_profit = current_price + (risk * 3)

    # æç›Šæ¯”
    ratio = (take_profit - current_price) / risk

    return {
        'stop_loss': stop_loss,
        'take_profit': take_profit,
        'risk_reward_ratio': ratio
    }
```

### 3.3 ç¯©é¸æ¢ä»¶æ‘˜è¦
1. âœ… 5MA > 10MA > 20MA > 60MA (å››ç·šå¤šé ­æ’åˆ—)
2. âœ… æç›Šæ¯” >= 3:1
3. âœ… æœ‰è¶³å¤ æˆäº¤é‡ (æ’é™¤å†·é–€è‚¡)

---

## 4. API è¨­è¨ˆ

### GET /api/stocks
å›å‚³ç¯©é¸çµæœæ¸…å–®

```json
{
  "updated_at": "2024-01-18T10:30:00",
  "market_status": "open",
  "stocks": [
    {
      "symbol": "2330.TW",
      "name": "å°ç©é›»",
      "price": 580.0,
      "change_pct": 1.2,
      "ma5": 575.0,
      "ma10": 570.0,
      "ma20": 560.0,
      "ma60": 540.0,
      "stop_loss": 560.0,
      "take_profit": 640.0,
      "risk_reward": 3.0
    }
  ]
}
```

### GET /api/chart/{symbol}
å›å‚³ K ç·šæ•¸æ“š

```json
{
  "symbol": "2330.TW",
  "candles": [
    { "time": 1705536000, "open": 570, "high": 582, "low": 568, "close": 580 }
  ],
  "ma_lines": {
    "ma5": [...],
    "ma10": [...],
    "ma20": [...],
    "ma60": [...]
  }
}
```

### GET /api/status
ç³»çµ±ç‹€æ…‹

```json
{
  "last_update": "2024-01-18T10:30:00",
  "next_update": "2024-01-18T10:35:00",
  "market_status": "open",
  "stocks_count": 50
}
```

---

## 5. å‰ç«¯ä»‹é¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”´ å°è‚¡å³æ™‚ç¯©é¸å™¨    æ›´æ–°: 10:30:00    âŸ³ ä¸‹æ¬¡: 10:35:00  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸ“‹ ç¬¦åˆæ¢ä»¶ (3æª”)   â”‚  â”‚         K ç·šåœ–è¡¨             â”‚â”‚
â”‚  â”‚                     â”‚  â”‚     (é»é¸å·¦å´è‚¡ç¥¨é¡¯ç¤º)       â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚â”‚
â”‚  â”‚ â”‚ 2330 å°ç©é›»     â”‚ â”‚  â”‚      ğŸ“ˆ Kç·š + å‡ç·šç–ŠåŠ        â”‚â”‚
â”‚  â”‚ â”‚ $580 â–²1.2%     â”‚ â”‚  â”‚   â”€â”€â”€â”€ 5MA  â”€â”€â”€ 10MA        â”‚â”‚
â”‚  â”‚ â”‚ R/R: 3.2       â”‚ â”‚  â”‚   ---- 20MA Â·Â·Â· 60MA        â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ â”‚ 2454 è¯ç™¼ç§‘     â”‚ â”‚  â”‚ ğŸ“Š äº¤æ˜“å»ºè­°                  â”‚â”‚
â”‚  â”‚ â”‚ $980 â–²0.8%     â”‚ â”‚  â”‚ åœæ: $560 | åœåˆ©: $640     â”‚â”‚
â”‚  â”‚ â”‚ R/R: 3.5       â”‚ â”‚  â”‚ æç›Šæ¯”: 3.2:1               â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. æª”æ¡ˆçµæ§‹

```
stock-analyzer/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py              # FastAPI å…¥å£ + è·¯ç”±
â”‚   â”œâ”€â”€ data_engine.py       # yfinance æ•¸æ“šæŠ“å–
â”‚   â”œâ”€â”€ screener.py          # ç­–ç•¥ç¯©é¸é‚è¼¯
â”‚   â”œâ”€â”€ scheduler.py         # APScheduler å®šæ™‚ä»»å‹™
â”‚   â”œâ”€â”€ config.py            # è¨­å®š (å°ç£50æ¸…å–®ã€æ›´æ–°é–“éš”)
â”‚   â””â”€â”€ requirements.txt     # ä¾è³´å¥—ä»¶
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html           # Vue 3 SPA
â”‚   â”œâ”€â”€ style.css            # Tailwind æ¨£å¼
â”‚   â””â”€â”€ app.js               # Vue å…ƒä»¶é‚è¼¯
â”‚
â”œâ”€â”€ data/
â”‚   â””â”€â”€ cache.json           # å¿«å–æœ€æ–°ç¯©é¸çµæœ
â”‚
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ plans/
â”‚       â””â”€â”€ 2026-01-18-realtime-stock-screener-design.md
â”‚
â””â”€â”€ README.md
```

---

## 7. éŒ¯èª¤è™•ç†

| æƒ…å¢ƒ | è™•ç†æ–¹å¼ |
|------|----------|
| yfinance è«‹æ±‚å¤±æ•— | é‡è©¦ 3 æ¬¡ï¼Œé–“éš” 10 ç§’ |
| å–®æª”è‚¡ç¥¨æ•¸æ“šä¸è¶³ | è·³éè©²è‚¡ï¼Œè¨˜éŒ„ log |
| API é™æµ | é™ç´šä½¿ç”¨ cache.json |
| éé–‹ç›¤æ™‚é–“ | é¡¯ç¤ºã€Œä¼‘å¸‚ä¸­ã€ï¼Œåœæ­¢è¼ªè©¢ |

---

## 8. å•Ÿå‹•æ–¹å¼

```bash
# å®‰è£ä¾è³´
cd backend && pip install -r requirements.txt

# å•Ÿå‹•å¾Œç«¯ (port 8000)
uvicorn main:app --reload

# é–‹å•Ÿå‰ç«¯
open frontend/index.html
```

---

## 9. åˆ†æç¯„åœ

**å°ç£ 50 æˆåˆ†è‚¡** (ç´„ 50 æª”)

å„ªé»ï¼š
- æµå‹•æ€§é«˜ï¼Œæ•¸æ“šç©©å®š
- æ¶µè“‹ä¸»è¦ç”¢æ¥­é¾é ­
- yfinance æ”¯æ´åº¦ä½³

---

## 10. ä¸‹ä¸€æ­¥

- [ ] å»ºç«‹ git å·¥ä½œå€
- [ ] å¯¦ä½œ backend æ ¸å¿ƒæ¨¡çµ„
- [ ] å¯¦ä½œ frontend å„€è¡¨æ¿
- [ ] æ•´åˆæ¸¬è©¦
- [ ] éƒ¨ç½²èªªæ˜
